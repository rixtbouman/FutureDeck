<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Futures Deck - Card Review</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Source+Sans+Pro:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Source Sans Pro', sans-serif;
      background: #0f0f15;
      color: #eee;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 30px;
    }

    .deck-switcher {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
    }

    .deck-btn {
      padding: 10px 20px;
      border: 2px solid #333;
      background: transparent;
      color: #888;
      border-radius: 25px;
      cursor: pointer;
      font-size: 0.9rem;
      text-decoration: none;
      transition: all 0.2s;
    }

    .deck-btn:hover {
      border-color: #555;
      color: #ccc;
    }

    .deck-btn.active {
      border-color: #60a5fa;
      color: #60a5fa;
      background: rgba(96, 165, 250, 0.1);
    }

    h1 {
      color: #60a5fa;
      font-family: 'Playfair Display', serif;
      font-size: 1.6rem;
      font-weight: 500;
      letter-spacing: 0.05em;
      margin-bottom: 10px;
    }

    .progress {
      background: #1a1a25;
      border-radius: 10px;
      height: 6px;
      margin: 15px 0;
      overflow: hidden;
    }

    .progress-bar {
      background: linear-gradient(90deg, #60a5fa, #a78bfa);
      height: 100%;
      transition: width 0.3s;
    }

    .progress-text {
      color: #888;
      font-size: 0.85rem;
    }

    .review-area {
      display: flex;
      gap: 50px;
      margin-bottom: 30px;
      align-items: flex-start;
    }

    .card-wrapper {
      flex: 0 0 auto;
    }

    .card-image {
      width: 320px;
      border-radius: 14px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.6);
    }

    .card-name {
      margin-top: 15px;
      text-align: center;
      font-family: 'Playfair Display', serif;
      font-size: 1.2rem;
      color: #fff;
    }

    .card-id {
      text-align: center;
      font-size: 0.8rem;
      color: #666;
      margin-top: 5px;
    }

    .rating-panel {
      flex: 1;
      max-width: 580px;
    }

    .rating-section {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 15px;
      border: 1px solid rgba(255,255,255,0.06);
    }

    .rating-section h3 {
      margin-bottom: 15px;
      color: #60a5fa;
      font-family: 'Playfair Display', serif;
      font-size: 0.95rem;
      font-weight: 500;
    }

    .rating-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 18px;
    }

    .rating-btn {
      flex: 1;
      padding: 14px;
      border: 2px solid #333;
      background: transparent;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }

    .rating-btn:hover {
      border-color: #555;
      background: rgba(255,255,255,0.03);
    }

    .rating-btn.selected {
      border-color: #60a5fa;
      background: rgba(96, 165, 250, 0.08);
    }

    .rating-btn .emoji { font-size: 1.8rem; }
    .rating-btn .label { color: #777; font-size: 0.75rem; }
    .rating-btn.selected .label { color: #60a5fa; }

    .rating-btn.thumbs-up.selected { border-color: #4ade80; background: rgba(74, 222, 128, 0.08); }
    .rating-btn.thumbs-up.selected .label { color: #4ade80; }
    .rating-btn.meh.selected { border-color: #fbbf24; background: rgba(251, 191, 36, 0.08); }
    .rating-btn.meh.selected .label { color: #fbbf24; }
    .rating-btn.thumbs-down.selected { border-color: #f87171; background: rgba(248, 113, 113, 0.08); }
    .rating-btn.thumbs-down.selected .label { color: #f87171; }

    .prompt-section {
      background: rgba(0,0,0,0.25);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
    }

    .prompt-section label {
      display: block;
      margin-bottom: 6px;
      color: #777;
      font-size: 0.8rem;
      font-weight: 500;
    }

    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #333;
      background: #1a1a1a;
      color: #eee;
      border-radius: 6px;
      font-family: inherit;
      font-size: 0.85rem;
      resize: vertical;
      min-height: 70px;
    }

    textarea:focus {
      outline: none;
      border-color: #60a5fa;
    }

    .nav-buttons {
      display: flex;
      gap: 15px;
      justify-content: space-between;
    }

    .nav-btn {
      padding: 12px 28px;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: 'Playfair Display', serif;
      font-weight: 500;
    }

    .nav-btn.prev { background: #2a2a2a; color: #ccc; }
    .nav-btn.prev:hover { background: #333; }
    .nav-btn.next {
      background: linear-gradient(135deg, #60a5fa, #a78bfa);
      color: #fff;
      font-weight: 600;
    }
    .nav-btn.next:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(96, 165, 250, 0.25);
    }
    .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }

    .filter-buttons {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .filter-btn {
      padding: 6px 14px;
      border: 1px solid #333;
      background: transparent;
      color: #777;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.75rem;
    }

    .filter-btn.active {
      border-color: #60a5fa;
      color: #60a5fa;
    }

    .summary-section {
      margin-top: 30px;
      padding: 22px;
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.06);
    }

    .summary-section h2 {
      color: #60a5fa;
      font-family: 'Playfair Display', serif;
      margin-bottom: 15px;
      font-size: 1.1rem;
      font-weight: 500;
    }

    .summary-stats {
      display: flex;
      gap: 25px;
      margin-bottom: 15px;
    }

    .stat { text-align: center; }
    .stat-number { font-size: 1.6rem; font-weight: bold; }
    .stat-label { color: #777; font-size: 0.8rem; }
    .stat.good .stat-number { color: #4ade80; }
    .stat.meh .stat-number { color: #fbbf24; }
    .stat.bad .stat-number { color: #f87171; }

    .export-btn {
      padding: 11px 22px;
      background: #60a5fa;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Playfair Display', serif;
    }

    .keyboard-hint {
      text-align: center;
      color: #555;
      font-size: 0.7rem;
      margin-top: 15px;
    }

    .keyboard-hint kbd {
      background: #2a2a2a;
      padding: 2px 6px;
      border-radius: 4px;
      margin: 0 2px;
    }

    @media (max-width: 900px) {
      .review-area {
        flex-direction: column;
        align-items: center;
      }
      .card-image {
        width: 280px;
      }
      .rating-panel {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="deck-switcher">
        <a href="https://alchemy-deck.vercel.app/review.html" class="deck-btn">Alchemy Deck</a>
        <a href="#" class="deck-btn active">Futures Deck</a>
      </div>

      <h1>Futures Deck Review</h1>
      <div class="progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="progress-text" id="progressText">Card 1 of 57</div>

      <div class="filter-buttons">
        <button class="filter-btn active" data-filter="all">All (57)</button>
        <button class="filter-btn" data-filter="unreviewed">Unreviewed</button>
        <button class="filter-btn" data-filter="up">Approved</button>
        <button class="filter-btn" data-filter="meh">Needs Work</button>
        <button class="filter-btn" data-filter="down">Rejected</button>
      </div>
    </header>

    <div class="review-area">
      <div class="card-wrapper">
        <img class="card-image" id="cardImage" src="" alt="">
        <div class="card-name" id="cardName"></div>
        <div class="card-id" id="cardId"></div>
      </div>

      <div class="rating-panel">
        <div class="rating-section">
          <h3>Rate this card</h3>
          <div class="rating-buttons">
            <button class="rating-btn thumbs-up" data-rating="up">
              <span class="emoji">üëç</span>
              <span class="label">Good to print</span>
            </button>
            <button class="rating-btn meh" data-rating="meh">
              <span class="emoji">üòê</span>
              <span class="label">Needs tweaking</span>
            </button>
            <button class="rating-btn thumbs-down" data-rating="down">
              <span class="emoji">üëé</span>
              <span class="label">Regenerate</span>
            </button>
          </div>

          <div class="prompt-section">
            <label>Notes:</label>
            <textarea id="commentInput" placeholder="e.g., 'Image too dark', 'Text unclear'..."></textarea>
          </div>
        </div>

        <div class="nav-buttons">
          <button class="nav-btn prev" id="prevBtn">‚Üê Previous</button>
          <button class="nav-btn next" id="nextBtn">Next ‚Üí</button>
        </div>

        <div class="keyboard-hint">
          <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> navigate &nbsp; <kbd>1</kbd> approve &nbsp; <kbd>2</kbd> meh &nbsp; <kbd>3</kbd> reject
        </div>
      </div>
    </div>

    <div class="summary-section" id="summarySection" style="display: none;">
      <h2>Review Summary</h2>
      <div class="summary-stats">
        <div class="stat good">
          <div class="stat-number" id="goodCount">0</div>
          <div class="stat-label">Approved</div>
        </div>
        <div class="stat meh">
          <div class="stat-number" id="mehCount">0</div>
          <div class="stat-label">Needs Work</div>
        </div>
        <div class="stat bad">
          <div class="stat-number" id="badCount">0</div>
          <div class="stat-label">Rejected</div>
        </div>
      </div>
      <button class="export-btn" id="exportBtn">Export JSON</button>
    </div>
  </div>

  <script>
    // All card IDs with names
    const cards = [
      // Arc (4)
      { id: "arc-01", name: "Growth" },
      { id: "arc-02", name: "Collapse" },
      { id: "arc-03", name: "Discipline" },
      { id: "arc-04", name: "Transformation" },
      // Terrain (16)
      { id: "terrain-01", name: "Agriculture" },
      { id: "terrain-02", name: "Warfare" },
      { id: "terrain-03", name: "Healthcare" },
      { id: "terrain-04", name: "Education" },
      { id: "terrain-05", name: "The Ocean" },
      { id: "terrain-06", name: "Governance" },
      { id: "terrain-07", name: "Entertainment" },
      { id: "terrain-08", name: "Transport" },
      { id: "terrain-09", name: "Religion" },
      { id: "terrain-10", name: "Commerce" },
      { id: "terrain-11", name: "Startups" },
      { id: "terrain-12", name: "Arts & Culture" },
      { id: "terrain-13", name: "Energy" },
      { id: "terrain-14", name: "Housing" },
      { id: "terrain-15", name: "Labor" },
      { id: "terrain-16", name: "Climate" },
      // Object (10)
      { id: "object-01", name: "Device" },
      { id: "object-02", name: "Law" },
      { id: "object-03", name: "Ritual" },
      { id: "object-04", name: "Beverage" },
      { id: "object-05", name: "Vehicle" },
      { id: "object-06", name: "Building" },
      { id: "object-07", name: "Garment" },
      { id: "object-08", name: "Game" },
      { id: "object-09", name: "Plant" },
      { id: "object-10", name: "Advertisement" },
      // Wellbeing (13)
      { id: "well-01", name: "Autonomy" },
      { id: "well-02", name: "Beauty" },
      { id: "well-03", name: "Comfort" },
      { id: "well-04", name: "Community" },
      { id: "well-05", name: "Competence" },
      { id: "well-06", name: "Fitness" },
      { id: "well-07", name: "Impact" },
      { id: "well-08", name: "Morality" },
      { id: "well-09", name: "Purpose" },
      { id: "well-10", name: "Recognition" },
      { id: "well-11", name: "Relatedness" },
      { id: "well-12", name: "Security" },
      { id: "well-13", name: "Stimulation" },
      // Timeframe (7)
      { id: "time-01", name: "Now" },
      { id: "time-02", name: "6 Months" },
      { id: "time-03", name: "1 Year" },
      { id: "time-04", name: "2 Years" },
      { id: "time-05", name: "5 Years" },
      { id: "time-06", name: "10 Years" },
      { id: "time-07", name: "20 Years" },
      // Modifiers (6)
      { id: "mod-01", name: "Major Breakthrough" },
      { id: "mod-02", name: "Accelerated Funding" },
      { id: "mod-03", name: "Steady Progress" },
      { id: "mod-04", name: "Technical Setback" },
      { id: "mod-05", name: "Funding Collapse" },
      { id: "mod-06", name: "Regulatory Delay" },
      // Card back
      { id: "card-back", name: "Card Back" }
    ];

    let currentIndex = 0;
    let currentFilter = 'all';
    let filteredCards = [...cards];
    let reviews = JSON.parse(localStorage.getItem('futuresDeckReviews') || '{}');

    const cardImage = document.getElementById('cardImage');
    const cardName = document.getElementById('cardName');
    const cardId = document.getElementById('cardId');
    const commentInput = document.getElementById('commentInput');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const summarySection = document.getElementById('summarySection');

    function applyFilter(filter) {
      currentFilter = filter;
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === filter);
      });

      if (filter === 'all') filteredCards = [...cards];
      else if (filter === 'unreviewed') filteredCards = cards.filter(c => !reviews[c.id]?.rating);
      else filteredCards = cards.filter(c => reviews[c.id]?.rating === filter);

      currentIndex = 0;
      updateDisplay();
      updateFilterCounts();
    }

    function updateFilterCounts() {
      const counts = {
        all: cards.length,
        unreviewed: cards.filter(c => !reviews[c.id]?.rating).length,
        up: cards.filter(c => reviews[c.id]?.rating === 'up').length,
        meh: cards.filter(c => reviews[c.id]?.rating === 'meh').length,
        down: cards.filter(c => reviews[c.id]?.rating === 'down').length
      };
      document.querySelectorAll('.filter-btn').forEach(btn => {
        const filter = btn.dataset.filter;
        const label = filter === 'all' ? 'All' : filter === 'unreviewed' ? 'Unreviewed' : filter === 'up' ? 'Approved' : filter === 'meh' ? 'Needs Work' : 'Rejected';
        btn.textContent = `${label} (${counts[filter]})`;
      });
    }

    function updateDisplay() {
      if (filteredCards.length === 0) {
        cardImage.src = '';
        cardName.textContent = 'No cards';
        cardId.textContent = '';
        return;
      }

      const card = filteredCards[currentIndex];
      const review = reviews[card.id] || {};

      cardImage.src = `assets/cards-final/${card.id}.png`;
      cardImage.alt = card.name;
      cardName.textContent = card.name;
      cardId.textContent = card.id;
      commentInput.value = review.comment || '';

      document.querySelectorAll('.rating-btn').forEach(btn => {
        btn.classList.toggle('selected', btn.dataset.rating === review.rating);
      });

      const progress = ((currentIndex + 1) / filteredCards.length) * 100;
      progressBar.style.width = `${progress}%`;
      progressText.textContent = `Card ${currentIndex + 1} of ${filteredCards.length}`;

      prevBtn.disabled = currentIndex === 0;
      nextBtn.textContent = currentIndex === filteredCards.length - 1 ? 'Finish' : 'Next ‚Üí';

      updateSummary();
    }

    function saveReview(rating) {
      const card = filteredCards[currentIndex];
      if (!reviews[card.id]) reviews[card.id] = {};
      reviews[card.id].rating = rating;
      reviews[card.id].comment = commentInput.value;
      reviews[card.id].timestamp = new Date().toISOString();
      localStorage.setItem('futuresDeckReviews', JSON.stringify(reviews));
      updateDisplay();
      updateFilterCounts();
    }

    function saveInputs() {
      const card = filteredCards[currentIndex];
      if (!reviews[card.id]) reviews[card.id] = {};
      reviews[card.id].comment = commentInput.value;
      localStorage.setItem('futuresDeckReviews', JSON.stringify(reviews));
    }

    function updateSummary() {
      const reviewedCount = Object.keys(reviews).filter(k => reviews[k].rating).length;
      if (reviewedCount > 0) {
        summarySection.style.display = 'block';
        document.getElementById('goodCount').textContent = Object.values(reviews).filter(r => r.rating === 'up').length;
        document.getElementById('mehCount').textContent = Object.values(reviews).filter(r => r.rating === 'meh').length;
        document.getElementById('badCount').textContent = Object.values(reviews).filter(r => r.rating === 'down').length;
      }
    }

    function exportReviews() {
      const exportData = {
        exported: new Date().toISOString(),
        deck: 'Futures Deck',
        summary: {
          total: cards.length,
          approved: Object.values(reviews).filter(r => r.rating === 'up').length,
          needsWork: Object.values(reviews).filter(r => r.rating === 'meh').length,
          rejected: Object.values(reviews).filter(r => r.rating === 'down').length
        },
        reviews: reviews
      };
      const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `futures-deck-review-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
    }

    document.querySelectorAll('.rating-btn').forEach(btn => btn.addEventListener('click', () => saveReview(btn.dataset.rating)));
    document.querySelectorAll('.filter-btn').forEach(btn => btn.addEventListener('click', () => applyFilter(btn.dataset.filter)));
    commentInput.addEventListener('blur', saveInputs);
    prevBtn.addEventListener('click', () => { saveInputs(); if (currentIndex > 0) { currentIndex--; updateDisplay(); } });
    nextBtn.addEventListener('click', () => { saveInputs(); if (currentIndex < filteredCards.length - 1) { currentIndex++; updateDisplay(); } });
    document.getElementById('exportBtn').addEventListener('click', exportReviews);

    document.addEventListener('keydown', (e) => {
      if (e.target === commentInput) return;
      if (e.key === 'ArrowLeft' && currentIndex > 0) { saveInputs(); currentIndex--; updateDisplay(); }
      else if (e.key === 'ArrowRight' && currentIndex < filteredCards.length - 1) { saveInputs(); currentIndex++; updateDisplay(); }
      else if (e.key === '1') saveReview('up');
      else if (e.key === '2') saveReview('meh');
      else if (e.key === '3') saveReview('down');
    });

    updateDisplay();
    updateFilterCounts();
  </script>
</body>
</html>
